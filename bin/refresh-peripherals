#!/bin/bash

# no audible bell
xset -b

# slightly insane keyrepeat
xset r rate 145 55

xkbcomp -I$HOME/dotfiles/xkb $HOME/dotfiles/keymap.xkb $DISPLAY
numlockx

# middle-click with three-finger tap; do nothing with one or two fingers
synclient TapButton1=0 TapButton2=0 TapButton3=2

[[ -f /tmp/display ]] && display=$(</tmp/display) || display=0
[[ " $* " == *" --cycle "* ]] && (( display++ ))
echo $display >/tmp/display

case $(hostname) in
    colinchan-x1)
        #xrandr \
        #    --output eDP-1 --auto --pos 2560x0 \
        #    --output HDMI-2 --auto --pos 0x0
        xrandr \
            --output eDP-1 --auto --pos 0x160 \
            --output DP-1-8 --auto --pos 2560x0 \
            --output DP-1-1 --auto --pos 5120x0

        # Set minimum brightness so the screen won't go entirely black
        light -Scr 1
        ;;
    lumeh)
        xrandr \
            --output LVDS1 --auto --primary --pos 1920x312 \
            --output HDMI1 --auto --pos 0x0 \
            --output VGA1 --auto --same-as LVDS1
        ;;
    apartmanteau)
        case $(( display % 2 )) in
            0)
                xrandr \
                    --output HDMI-0 --auto --primary \
                    --output DVI-I-1 --off
                #xrandr \
                #    --output DVI-I-1 --auto --primary \
                #    --output HDMI-0 --off
                ;;
            1)
                xrandr \
                    --output HDMI-0 --auto --primary \
                    --output DVI-I-1 --auto --left-of HDMI-0
                ;;
        esac
        ;;
esac

feh --bg-fill ~/.wallpaper || { pgrep -x variety >/dev/null && variety --next || variety &>/dev/null & }
paplay /usr/share/sounds/freedesktop/stereo/window-attention.oga
